---
title: "Humidity in Melbourne"
author: "Yin Shan Ho, Yu Luo, Zoljargal Batsaikhan"
institute: "Monash University"
date: "`r Sys.Date()`"
output:
  xaringan::moon_reader:
    lib_dir: libs
    seal: false
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

class: center, bottom, inverse

background-image: url(https://www.rmets.org/sites/default/files/2021-05/UoR%20Weather%20Game%20banner.png)

background-position: top

# Humidity in Melbourne

## Yin Shan Ho, Yu Luo, Zoljargal Batsaikhan

## Monash University

### `r Sys.Date()`

---

background-image: url(https://www.melbournegems.com/images/xmelbourne-weather.jpg.pagespeed.ic.UX-q8gxi4B.jpg)

background-size: 60%

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
library(tidyverse)
library(lubridate)
library(leaflet)
library(kableExtra)
options(htmltools.dir.version = FALSE)
```

# The 'crazy' weather in Melbourne

.footnote[Image credit: [melbournegems](https://www.melbournegems.com/melbourne-weather.html#sthash.yzWUj1YE.dpbs)]

---

class: inverse

```{css, echo = FALSE}
.index-font {
  font-size: 30px;
  font-color: grey;
}
```

# Index

--

.index-font[
- Introduction

]
--

.index-font[
- Data Description
]

--

.index-font[
- Analysis

 1. Overview trend of humidity
 2. Humidity change by time and sites
 3. Correlations of humidity to other variables
]
 
--
 
.index-font[
- Conclusions and limitations
]

---



##Introduction

--

- [Humidity Check](https://humiditycheck.com/comfortable-humidity-level-outside)  
the relative humidity level outside is considered comfortable between 30% and 50%.  

--

- [Environmental Protection Agency](https://www.epa.gov/mold/mold-course-chapter-2)  
the relative humidity should be kept below 60 percent

--

## Questions

--

- How does relative humidity in Melbourne change throughout the measured time?

--

- When is it most uncomfortable to walk around the city (humidity below 30% or above 60%)?

---
## Data Description

```{r}
locations <- read_csv("data/locations.csv")
```

--

- The location.csv data is downloaded from [City of Melbourne- Microclimate-Sensor-locations](https://data.melbourne.vic.gov.au/Environment/Microclimate-Sensor-Locations/irqv-hjr4) 

--

- Contains the location and location description for each microclimate sensor device installed throughout the city.

--

## The locations of the sensor in Map

```{r sensor-location, out.height='45%', out.width='100%'}
locations$description <- paste0("Site",locations$site_id, ", ", locations$description)
  
locations %>%
      leaflet() %>%
      addMarkers(
        lng = ~longitude,
        lat = ~latitude,
        popup = ~description,
        layerId = ~site_id
      ) %>%
      addTiles()
```

---

## Summary of locations.csv

``` {css, echo = FALSE} 
    .pull-left {
      float: left;
    }

    .pull-right {
     width: 35%;
    }
```

--

```{r loction-miss, fig.height=5, fig.width=10}
visdat::vis_dat(locations)+
  labs(x = "Variables")
```

--

- Data types: **Numeric**, **Character**, **Date**

--

- **end_reading** all missing

--

- 4th data missing in **last_data**.
---

## Summary of weather.csv
--

```{r weather-miss,fig.height=6, fig.width=10}
weather <- read_csv("data/weather.csv")

visdat::vis_dat(weather)+
  labs(x = "Variables")+
  theme(axis.text.x = element_text(angle =45))
```
--

- Downloaded from [City of Melbourne- Microclimate-Sensor-Readings](https://data.melbourne.vic.gov.au/Environment/Microclimate-Sensor-Readings/u4vh-84j8) 

--

- Contains environmental readings from microclimate sensors

---

## Count of the obseravations in weather.csv

``` {css, echo = F} 
    .pull-left {
      width: 70%;
    }

    .pull-right {
     width: 30%;
    }
```

--

.pull-left[

```{r obs-count, out.height = '80%'}
weather %>% group_by(site_id, local_date) %>% 
  count() %>% 
  ggplot(aes(x = local_date,
             y = n)) + 
  geom_col(fill = "#0C85E4") +
  facet_wrap(~ site_id, ncol = 3)+
  labs(x = "Date",
       y = "Number of Observations")+
  theme(axis.text.x = element_blank(),
        axis.ticks.x = element_blank())+
  theme_classic()
```

]

--

.pull-right[

- The data is from `r first(weather$local_date)` to   `r last(weather$local_date)`.

- Updated every 15 minutes 

- 4obs $\times$ 24hr/day   $=$ 96obs/day

- To determine microclimate changes
]
---

## The data dictionary of :

--

- locations.csv

```{r}
data.frame(Variables = names(locations),
           Description = c("Unique location id referring to the location of sensor device (used to link the location of the sensor device to the Microclimate Sensor Readings dataset",
                           "Unique sensor device id. One sensor device will contain multiple microclimate sensors (used in combination with the site_id to link to the Microclimate Sensor Readings dataset",
                           "Description of the location of the sensor device",
                           "Date and time when the last data was sent from a sensor associated with the sensor device",
                           "Indicates if the site is a historic location for the sensor device or currently in use. R = retired, the location is no longer in use. C = current, the present location of the sensor device",
                           "Date and time sensor device began transmitting data from this site",
                           "Longitude of the site",
                           "Latitude of the site",
                           "Type of the location",
                           "Date and time sensor device stopped transmitting data from this site"),
           Datatype = c("Numeric",
                        "Character",
                        "Character",
                        "Date",
                        "Character",
                        "Date",
                        "Numeric",
                        "Numeric",
                        "Character",
                        "Date"   )) %>% 
  kable(align = "l", 
        col.names = c("Variables","Description", "Data-type")) %>% 
  row_spec(0, color = "white", background = "#0C85E4", align = "c") %>% 
  kable_styling(bootstrap_options = "striped", font_size = 12) %>% 
  scroll_box(width = "100%")  
```

--

- Source data of weather.csv is accessible [Here](https://data.melbourne.vic.gov.au/api/views/u4vh-84j8/files/a2a9a6e3-2d46-4469-8d04-3335306034d5?download=true&filename=MicroClimateSensors_Metadata_Attachment_DataDictionary.pdf)

---


class: inverse, middle, center


    <img src="https://static-int.testo.com/media/4c/fa/4655130c014a/Teaser-Unterseiten-2000x1500pix_master.jpg" style="width: 70%" />


# Analysis

.footnote[Image credit: [testo](https://www.testo.com/en-AU/products/air-humidity-meter)]
---

# Overall trend of the humidity in Melbourne

```{r}
weather_tidy <- weather %>% 
  mutate(local_date = as.Date(local_date),
         time = case_when(
           minute == 0 ~ paste0(hour,".0"),
           minute == 15 ~ paste0(hour,".25"),
           minute == 30 ~ paste0(hour,".5"),
           minute == 45 ~ paste0(hour,".75")),
         time = as.double(time),
         site_id = as.character(site_id),
         month = month(local_date),
         datetime = make_datetime(year = year, 
                                  month = month, 
                                  day = day, 
                                  hour = hour, 
                                  min = minute,
                                  sec = 0, 
                                  tz = "Australia/Melbourne"))%>% 
  filter(!is.na(relative_humidity_percent))
```

--

```{r overall-humidity, fig.height=5, fig.width=10}
weather_tidy %>%
  ggplot() +
  geom_line(aes(x = datetime,
                y = relative_humidity_percent),
            color = "#0C85E4") +
  geom_smooth(aes(x = datetime,
                  y = relative_humidity_percent),
              color = "red3",
              se = FALSE)+
  theme_bw()+
  labs(x = "Date",
       y = "Relative Humidity(%)")+
  theme(legend.position = "none") +
  scale_color_brewer(palette = "Dark2")

```

--

- Huge variation of the Relative Humidity(RH)

--

- Rising trend of RH before and after Winter

--

- Downward trend  of RH in Winter time (Mid Jun to Sep)


   
---

class: center, middle

# Thanks!

Slides created via the R package [**xaringan**](https://github.com/yihui/xaringan).

The chakra comes from [remark.js](https://remarkjs.com), [**knitr**](https://yihui.org/knitr/), and [R Markdown](https://rmarkdown.rstudio.com).
